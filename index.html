<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday ❤️</title>
  <style>
    :root{--bg1:#ff9a9e;--bg2:#fad0c4;--card:#ffffff;--accent:#ff6b6b}
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));}
    .wrap{width:92%;max-width:980px;background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(255,255,255,0.95));border-radius:18px;padding:28px;box-shadow:0 10px 30px rgba(0,0,0,0.12);display:grid;grid-template-columns:1fr 360px;gap:20px;align-items:center}
    .card-left{padding:12px}
    h1{margin:0;font-size:clamp(24px,4vw,36px);letter-spacing:0.4px}
    p.lead{margin:8px 0 18px;color:#5b5b5b}
    .big-msg{background:linear-gradient(90deg,#ff9a9e,#ffd1dc);padding:18px;border-radius:12px;font-weight:700;display:flex;align-items:center;gap:12px}
    .name{font-size:1.2rem;color:var(--accent)}
    .actions{margin-top:14px;display:flex;gap:8px}
    button{cursor:pointer;border:0;padding:10px 14px;border-radius:10px;font-weight:600}
    .btn-primary{background:var(--accent);color:white}
    .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}

    /* right column */
    .card-right{padding:14px;border-radius:12px;display:flex;flex-direction:column;align-items:center;gap:12px}
    .avatar{width:120px;height:120px;border-radius:999px;background:linear-gradient(180deg,#fff,rgba(255,255,255,0.6));display:flex;align-items:center;justify-content:center;font-size:56px;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
    label{font-size:13px;color:#444}
    input[type=text]{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);font-size:15px}
    textarea{width:100%;min-height:120px;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);resize:vertical;font-size:14px}
    .preview{width:100%;padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:inset 0 1px 0 rgba(0,0,0,0.02);text-align:center}

    /* confetti canvas */
    #confetti{position:fixed;left:0;top:0;pointer-events:none;width:100%;height:100%;z-index:999}

    /* small footer */
    .meta{font-size:12px;color:#666;margin-top:8px}

    @media (max-width:880px){.wrap{grid-template-columns:1fr;}}

    /* little heart pulse */
    .heart{display:inline-block;transform-origin:center center;animation:pulse 1.25s infinite}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="wrap" role="main">
    <div class="card-left">
      <h1>Happy Birthday 🎂 <span class="heart">❤️</span></h1>
      <p class="lead">Thân gửi! Supeo iu dấu đã đến với tâm tình của anh 🤍</p>

      <div class="big-msg" id="intro">
        <div style="flex:1">
          <div style="font-size:14px;color:#333">Cho:</div>
          <div class="name" id="toName">Đặng Thu Thảo aka SuPeo</div>
        </div>
        <div style="font-size:12px;color:#4d4d4d">Tuổi mới: <strong id="ageDisplay"></strong></div>
      </div>

      <div class="actions">
        <button class="btn-primary" id="surpriseBtn">🎉Bấm đi có điều bất ngờ 🎉</button>
        <button class="btn-ghost" id="playBtn">▶️ Vui tai nè 🎆</button>
        <!--<button class="btn-ghost" id="printBtn">🖨 In/Save</button>-->
      </div>

      <div style="margin-top:18px">
        <div style="font-size:14px;font-weight:700;margin-bottom:6px">Lời chúc của Tây:   </div>
        <div class="preview" id="sample">
          Chúc em tuổi mới tràn đầy nụ cười, sức khoẻ và những điều tuyệt vời. Anh xin lỗi vì hôm nay, và anh mong chúng mình sẽ bắt đầu lại nhẹ nhàng từ ngày đặc biệt này. ❤️
        </div>
      </div>

    </div>

    <aside class="card-right">
      <div class="avatar" id="avatarPreview">💋</div>

      <div style="width:100%">
        <label>Princess của hôm nay là</label>
        <input type="text" id="nameInput" placeholder="Nhập tên người yêu..." value="Đặng Thu Thảo">
      </div>

      <div style="width:100%">
        <label>Tuổi</label>
        <input type="text" id="ageInput" placeholder="" value="17 years">
      </div>

      <div style="width:100%">
        <label>Điều anh muốn nói. Chú ý phần này chỉ xem chứ đừng gõ chữ vào ô này nha 🤞</label>
        <textarea id="msgInput" placeholder="Tô Thành Tây yêu Đặng Thu Thảo"></textarea>
      </div>

      <div style="width:100%">
        <!--<div class="meta">Tip: bạn có thể paste 1 emoji để thay avatar — ví dụ: 😘 🐥 🌸</div>-->
      </div>
    </aside>
  </div>

  <script>
    // Elements
    const nameInput = document.getElementById('nameInput');
    const ageInput = document.getElementById('ageInput');
    const msgInput = document.getElementById('msgInput');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const playBtn = document.getElementById('playBtn');
    const printBtn = document.getElementById('printBtn');
    const toName = document.getElementById('toName');
    const ageDisplay = document.getElementById('ageDisplay');
    const avatar = document.getElementById('avatarPreview');
    const sample = document.getElementById('sample');

    nameInput.addEventListener('input', ()=>{toName.textContent = nameInput.value || 'Người thương'; avatar.textContent = firstEmoji(nameInput.value) || '😘'});
    ageInput.addEventListener('input', ()=>{ageDisplay.textContent = ageInput.value || '—'});
    msgInput.addEventListener('input', ()=>{sample.textContent = msgInput.value || sampleDefault});

    const sampleDefault = sample.textContent;

    function firstEmoji(text){ if(!text) return '';
      const m = Array.from(text).find(ch => /\p{Emoji}/u.test(ch));
      return m || '';
    }

    // Confetti implementation (simple)
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');
    let W = confettiCanvas.width = innerWidth;
    let H = confettiCanvas.height = innerHeight;
    window.addEventListener('resize', ()=>{W = confettiCanvas.width = innerWidth; H = confettiCanvas.height = innerHeight});

    class Confetti{
      constructor(){ this.x = Math.random()*W; this.y = Math.random()*-H; this.r = 6+Math.random()*8; this.d = Math.random()*60+10; this.tilt = Math.random()*10; this.color = `hsl(${Math.floor(Math.random()*360)},80%,60%)`; this.speed = 1+Math.random()*3 }
      draw(){ ctx.beginPath(); ctx.fillStyle=this.color; ctx.moveTo(this.x, this.y); ctx.lineTo(this.x+this.r, this.y+this.r/2+this.tilt); ctx.lineTo(this.x, this.y+this.r); ctx.closePath(); ctx.fill(); }
      update(){ this.y += this.speed; this.x += Math.sin(this.y/50); if(this.y>H+20){ this.y = -10; this.x = Math.random()*W }}
    }
    let confs = [];
    function launchConfetti(amount=120){ confs = []; for(let i=0;i<amount;i++) confs.push(new Confetti()); runConfetti(); }
    let confRunning=false;
    function runConfetti(){ if(confRunning) return; confRunning=true; function loop(){ ctx.clearRect(0,0,W,H); for(let c of confs){ c.update(); c.draw(); } if(confRunning) requestAnimationFrame(loop); } loop(); setTimeout(()=>{ confRunning=false; ctx.clearRect(0,0,W,H) },4000); }

    // Sound: tiny melody via WebAudio
    let audioCtx=null; function playMelody(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); const now = audioCtx.currentTime; const notes = [523.25,659.25,783.99,1046.5]; // C5 E5 G5 C6
      notes.forEach((freq,i)=>{ const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type='sine'; o.frequency.value = freq; o.connect(g); g.connect(audioCtx.destination); g.gain.value = 0.0001; o.start(now + i*0.25); g.gain.linearRampToValueAtTime(0.08, now + i*0.25 + 0.01); g.gain.linearRampToValueAtTime(0.0001, now + i*0.25 + 0.24); o.stop(now + i*0.25 + 0.26); }); }

    // Surprise action
    surpriseBtn.addEventListener('click', ()=>{
      const name = nameInput.value || 'Em yêu';
      const age = ageInput.value || '';
      const custom = msgInput.value.trim();
      const message = custom || `Mặc dù hôm nay với từ trước kia đến nay vốn chúng mình đã không hoà hợp được. Nhưng mà chung quy lại, gạt bỏ qua hết, anh muốn em có 1 hôm sinh nhật thật trọn vẹn. 🤍Chúc em sang tuổi mới an nhiên, luôn vui vẻ, xinh đẹp và luôn hạnh phúc nhen. Quà thì anh cũng góp tiền tặng em roii, xin lỗi vì không gói được quà cho em tại hàng ship về là su nhận hàng rồi. Thứ lỗi cho anh nha. Đồ handmade anh không chuẩn bị được gì nhiều nhưng mà a sẽ gửi em ngày gần nhất nha. Bỏ qua hết nha. Thiên thần nhỏ có sinh nhật vui vẻ ạaa ❤`;
      // show modal-like effect
      sample.textContent = message;
      toName.textContent = name;
      ageDisplay.textContent = age || '—';
      launchConfetti(160);
      playMelody();
      // tiny visual pulse
      document.querySelector('.heart').style.transform = 'scale(1.3)'; setTimeout(()=>document.querySelector('.heart').style.transform='scale(1)',700);
      // small browser notification (permission)
      if('Notification' in window){ if(Notification.permission==='granted') new Notification('Happy Birthday 🎂', {body: message.slice(0,80)+'...'})
        else if(Notification.permission!=='denied') Notification.requestPermission().then(p=>{ if(p==='granted') new Notification('Happy Birthday 🎂', {body: message.slice(0,80)+'...'}) }) }
    });

    // Play/stop music
    let playing=false;
    playBtn.addEventListener('click', ()=>{ playMelody(); });

    // Print
    printBtn.addEventListener('click', ()=>{ window.print(); });

    // keyboard quick-send: ctrl+enter
    window.addEventListener('keydown',(e)=>{ if(e.ctrlKey && e.key==='Enter'){ surpriseBtn.click(); } });

    // Accessibility: focus first input
    nameInput.focus();
  </script>
</body>
</html>
